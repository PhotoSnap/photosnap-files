!function(){function e(e){this.inventory=e,this.inventoryIndex=this.createInventoryIndex(),this.selectedItems={},this.normalHours=4,this.idleHours=0,this.travelDistance=0;var t=new Date;this.eventMonth=t.getMonth().toString(),this.eventDate=null,this.eventAddress=null,this.priceElements=document.querySelectorAll(".price-link"),this.init(),this.initListeners()}e.prototype.export=function(){return{selectedItems:this.selectedItems,normalHours:this.normalHours,idleHours:this.idleHours,eventDate:this.eventDate,travelDistance:this.travelDistance,location:this.eventAddress,quote:this.priceElements[0].innerText}},e.prototype.init=function(){this.dateTiles=DatePickerTile.initAndGetTiles('[data-tile-type="datepicker"]',this.inventory.monthly_pricing),this.mapTiles=DistanceTile.initAndGetTiles('[data-tile-type="address"]',this.inventory.drive_pricing),this.hourTiles=HourTile.initAndGetTiles('[data-tile-type="hours"]',{min:2,max:8760}),this.idleHourTiles=HourTile.initAndGetTiles('[data-tile-type="idlehours"]',{min:0,max:8760}),this.styleTiles=SelectableTile.initAndGetTiles('[data-tile-type="booth_style"]'),this.sizeTiles=SelectableTile.initAndGetTiles('[data-tile-type="photostripsize"]'),this.extraTiles=SelectableTile.initAndGetTiles('[data-tile-type="extra"]',!0),this.shelterTiles=SelectableTile.initAndGetTiles('[data-tile-type="shelter"]'),this.externalPower=SelectableTile.initAndGetTiles('[data-tile-type="external_power"]')},e.prototype.createInventoryIndex=function(){var e={};for(var t in this.inventory){var i=this.inventory[t];for(var n in i){var s=i[n];s.id&&(e[s.id]=s)}}return e};var t=function(e,t,i){for(var n=0;n<e.length;n++)e[n].addEventListener(t,i)};e.prototype.initListeners=function(){var e=this;t(this.idleHourTiles,"change",function(t,i){e.idleHours=i.hours,e.calculateTotal()}),t(this.hourTiles,"change",function(t,i){e.normalHours=i.hours,e.calculateTotal()}),t(this.mapTiles,"change",function(t,i){e.travelDistance=i.miles,e.eventAddress=i.eventAddress,e.calculateTotal()}),t(this.dateTiles,"change",function(t,i){e.eventMonth=i.month,e.eventDate=i.fullDate,e.calculateTotal()}),t(this.styleTiles.concat(this.sizeTiles).concat(this.extraTiles).concat(this.shelterTiles).concat(this.externalPower),"change",function(t,i){var n=e.inventoryIndex[i.item_id];i.selected?e.addSelectedItem(n.id):e.removeSelectedItem(n.id),e.calculateTotal()})},e.prototype.setSelections=function(e){for(var t=this.styleTiles.concat(this.sizeTiles).concat(this.extraTiles).concat(this.shelterTiles).concat(this.externalPower),i=0;i<t.length;i++)e.indexOf(t[i].getId())>=0&&t[i].select(!0)},e.prototype.calculateTotal=function(){var e=0;e+=this.calculateHours(),e+=this.calculateIdleHours(),e+=this.calculateDriveCharge(),e+=this.calculateEventDateCharge(),e+=this.calculateSelectedItems(),this.render(e)},e.prototype.calculateEventDateCharge=function(){return 0===this.dateTiles.length?0:this.dateTiles[0].calculatePrice(this.eventMonth)},e.prototype.calculateDriveCharge=function(){return 0===this.mapTiles.length?0:this.mapTiles[0].calculateDistanceCharge(this.travelDistance).extraCharge},e.prototype.calculateIdleHours=function(){return this.idleHours*this.inventory.hour_pricing.idle_hour_price},e.prototype.calculateHours=function(){var e=this.inventory.hour_pricing,t=this.normalHours.toString();if(t in e.fixed_hours)return e.fixed_hours[t];var i=this.getMaxFixedHour();return e.fixed_hours[i.toString()]+(this.normalHours-i)*e.per_hour_price},e.prototype.calculateSelectedItems=function(){var e=0;for(var t in this.selectedItems){e+=this.inventoryIndex[t].additionalPrice}return e},e.prototype.getMaxFixedHour=function(){var e=[];for(var t in this.inventory.hour_pricing.fixed_hours){var i=parseInt(t);e.push(i)}return e.sort(),e[e.length-1]},e.prototype.render=function(e){for(var t="$"+e,i=0;i<this.priceElements.length;i++)this.priceElements[i].innerHTML=t},e.prototype.addSelectedItem=function(e){this.selectedItems[e]=!0},e.prototype.removeSelectedItem=function(e){e in this.selectedItems&&delete this.selectedItems[e]},window.Cart=e}();